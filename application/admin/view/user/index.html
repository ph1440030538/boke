{extend name="base" /}
{block name="head"}
{/block}
{block name="main"}
<div id="fuyun-app" class="fuyun-app">
<!--   <div class="search-box">
    <div class="fuyun-title">
      <h5>筛选条件</h5>
    </div>
    <div class="search-content">
      <form action="" method="">
        <div class="fuyun-form-item layui-inline">
          <label>品牌名称</label>
          <input class="layui-input" type="text" name="brand_name" value="" placeholder="输入品牌名称">
        </div>
        <div class="fuyun-form-item layui-inline" style="padding-top:18px;">
          <button class="layui-btn layui-btn-normal">搜索</button>
        </div>
      </form>
    </div>
  </div> -->

  <div class="content-box ">
    <div class="fuyun-title">
      <h5>用户列表</h5>
      <a href="{:Url('add')}" class="layui-btn fuyun-add-btn layui-btn-small layui-btn-normal add"><i class="fa fa-plus-square margin-right-5"></i>添加用户</a>
    </div>
    <div class="main-box">
      <div class="layui-form">
        <table class="layui-table layui-form">
          <thead>
            <tr>
              <th width="3%"><input type="checkbox" name="" lay-skin="primary" lay-filter="allChoose"></th>
              <th>用户名</th>
              <th>头像</th>
              <th width="20%">操作</th>
            </tr> 
          </thead>
          <tbody>
            {volist name="list['data']" id="vo"}
              <tr data-id="{$vo.id}">
                <td><input type="checkbox" name="id[]" lay-skin="primary" value="{$vo.id}" ></td>
                <td class='layui-elip'>{$vo.username}</td>
                <td class='layui-elip'><img class='td_image' src="{$vo.avatar}" alt="{$vo.avatar}"  /></td>
                <td>
                  <div class="layui-btn-group">
                    <a class="layui-btn layui-btn-normal layui-btn-small" href="{:Url('edit')}?id={$vo['id']}">编辑</a>
                    <a class="layui-btn layui-btn-small" href="javascript:;" onclick="rule({$vo['id']})" >权限</a>
                    <a class="layui-btn layui-btn-small" href="javascript:;" onclick="menu({$vo['id']})" >菜单</a>
                    <a class="layui-btn fuyun-btn-del layui-btn-small" href="javascript:;" onclick="del({$vo.id})" >删除</a>
                  </div>
                </td>
              </tr>
            {/volist}
          </tbody>
            <tfoot>
              <tr>
                <th width="2%"><input type="checkbox" name="" lay-skin="primary" lay-filter="allChoose"></th>
                <th colspan="8" class="operator-button" style="text-align:left">
                    <button class="layui-btn layui-btn-small fuyun-btn-del btn-del-ids" data-url="{:Url('deleteAll')}" data-confirm="确定要批量删除吗?" data-successtip="批量删除成功!"  method-type="post" style="margin-top:5px"><i class="fa fa-close margin-right-5"></i>批量删除</button>
                </th>
              </tr>
            </tfoot>
        </table>
      </div>
      <div class="page-box">
        <fuyun-page 
          :pagesize="<?=$list['pageSize']?>" 
          :total = "<?=$list['totalRow']?>"
          :current-page = {$list['curPage']}
        ></fuyun-page>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
    layui.use([ 'layer','form'], function(){
      var layer = layui.layer;
      var form = layui.form();
      //全选
      form.on('checkbox(allChoose)', function(data){
          var child = $(data.elem).parents('table').find('tbody input[type="checkbox"]');
          child.each(function(index, item){
              item.checked = data.elem.checked;
          });
          form.render('checkbox');
      });
    });

    fuyun.components(['page'],{
      el:"#fuyun-app",
      data:{
        labelPosition: 'top',
      },
    });

  function rule(uid){
    layer.open({
        type: 2,
        area:['800px','600px'],
        content: "{:Url('rule')}?uid="+uid
    });
  }

  function menu(uid){
    layer.open({
      type: 2,
      area:['800px','600px'],
      content: "{:Url('menu')}?uid="+uid
    });
  }

</script>

{/block}
