{extend name="base" /}
{block name="head"}

{/block}
{block name="main"}
<div id="fuyun-app" class="fuyun-app">
  <div class="fuyun-title">
    <h5>添加数据</h5>
    <a href="{:Url('index')}" class="layui-btn fuyun-add-btn layui-btn-small layui-btn-normal"><i class="fa fa-plus-square margin-right-5"></i>返回</a>
  </div>
  <div class="content-box">
    <form class="layui-form padding-10" action="{:Url('add')}" method="post">
			
			<div class="layui-form-item">
				<label class="layui-form-label">名字</label>
				<div class="layui-input-inline">
					<input type="text" name="name" placeholder="请输入名字" class="layui-input" >
				</div>
			</div>
			
			<div class="layui-form-item">
				<label class="layui-form-label">关键字</label>
				<div class="layui-input-inline">
					<input type="text" name="keyword" placeholder="请输入关键字" class="layui-input" >
				</div>
			</div>
			
			<div class="layui-form-item">
				<label class="layui-form-label">图片</label>
				<div class="layui-input-inline image_upload_box">
					<input id="image" type="text" name="image" placeholder="请输入图片" class="layui-input preview_img" >
				</div>
				<div class="layui-input-inline">
					<input type="file" name="imageIMA" lay-type="IMA" class="layui-upload-image layui-upload-file">
					<a href="javascript:;" class="layui-btn layui-btn-primary" onclick="preview_img(this)">预览</a>
				</div>
				<script type="text/javascript">
					layui.use(["upload"],function(){
						layui.upload({
							url: "{:Url('upload/image')}"
							,elem: ".layui-upload-image"
							,success: function(res){
								$("#image").val(res.data.src);
							}
						});  
					});
				</script>
			</div>
			
            <div class="layui-form-item">
            	<label class="layui-form-label">类型</label>
                <div class="layui-input-inline">
                    <select name="type">
                        <option value='0'>input</option><option value='1'>select</option>
                    </select>
                </div>
            </div>
			
			<div class="layui-form-item">
				<label class="layui-form-label">内容</label>
				<div class="layui-input-block">
				    <link href="/static/umeditor/themes/default/css/umeditor.css" type="text/css" rel="stylesheet">
				    <script type="text/javascript" src="/static/umeditor/third-party/jquery.min.js"></script>
				    <script type="text/javascript" src="/static/umeditor/third-party/template.min.js"></script>
				    <script type="text/javascript" charset="utf-8" src="/static/umeditor/umeditor.config.js"></script>
				    <script type="text/javascript" charset="utf-8" src="/static/umeditor/umeditor.min.js"></script>
				    <script type="text/javascript" src="/static/umeditor/lang/zh-cn/zh-cn.js"></script>

					<script type="text/plain" id="myEditor" name="content" style="width:860px;height:240px;"></script>
					<script type="text/javascript">
					    var um = UM.getEditor("myEditor");
					</script>
				</div>
			</div>
			
			<div class="layui-form-item">
				<label class="layui-form-label">banner图片</label>
				<div class="layui-input-inline">
					<input type="text" name="banner_image" placeholder="请输入banner图片" class="layui-input" >
				</div>
			</div>
			
			<div class="layui-form-item">
				<div class="layui-input-block">
					<button class="layui-btn" lay-submit lay-filter="formDemo">立即提交</button>
					<button type="reset" class="layui-btn layui-btn-primary">重置</button>
				</div>
			</div>
    </form>
  </div>
</div>
<script type="text/javascript">

  layui.use(['form'], function(){
      var form = layui.form();
    form.on('submit(formDemo)', function(data){
      var that = this;
      $(that).attr("disabled","disabled"); 
      $.ajax({ 
        type: "post", 
        url: data.form.action, 
        data: data.field,
        dataType: 'json', 
        success: function(result){ 
          if(result['code'] == 1){
            window.location.href = document.referrer;
            layer.msg(result['msg']);
          }else{
            layer.msg(result['msg']);
            $(that).removeAttr("disabled");
          }
        } 
      });

      return false;
    });
  })
</script>
{/block}


