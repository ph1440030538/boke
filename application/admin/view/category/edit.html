{extend name="base" /}
{block name="head"}
<style type="text/css">
	.layui-form{width: 60%;margin-left: 10%;}
</style>
{/block}
{block name="main"}
<div id="fuyun-app" class="fuyun-app">
  <div class="fuyun-title">
    <h5>编辑数据</h5>
    <a href="{:Url('index')}" class="layui-btn fuyun-add-btn layui-btn-small layui-btn-normal"><i class="fa fa-plus-square margin-right-5"></i>返回</a>
  </div>
	<div class="content-box">
    <form class="layui-form padding-10" action="{:Url('edit')}" method="post">
			<div class="layui-form-item">
				<label class="layui-form-label">上级分类</label>
				<div class="layui-input-block">
					<select name="parent_id" lay-verify="">
						<option value="">请选择分类</option>
						<option value="0" <?php if($model['parent_id']==0){echo 'selected';} ?> >最高级</option>
						{volist name='categoryList' id='category'}
							<option value="{$category['id']}" <?php if($category['id']==$model['parent_id']){echo 'selected';} ?> >{$category['name']}</option>
						{/volist}
					</select>   
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">分类名字</label>
				<div class="layui-input-block">
					<input type="text" name="name" lay-verify="title" autocomplete="off" placeholder="请输入分类名字" class="layui-input" value="{$model.name}" />
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">seo标题</label>
				<div class="layui-input-block">
					<input type="text" name="seo_title" lay-verify="title" autocomplete="off" placeholder="请输入seo标题" class="layui-input" value="{$model.seo_title}" />
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">seo关键字</label>
				<div class="layui-input-block">
					<input type="text" name="seo_keywords" lay-verify="seo_keywords" autocomplete="off" placeholder="请输入seo关键字" class="layui-input" value="{$model.seo_keywords}" />
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">seo描述</label>
				<div class="layui-input-block">
					<input type="text" name="seo_desribe" lay-verify="seo_desribe" autocomplete="off" placeholder="请输入seo描述" class="layui-input" value="{$model.seo_desribe}" />
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">列表模板</label>
				<div class="layui-input-block">
					<select name="list_tpl" lay-verify="aihao">
						<option value="0">暂不选择</option>
						{foreach $listTpl as $key => $vo}
							<option {if condition="$vo eq $model['list_tpl']"}selected{/if} value="{$vo}">{$vo}</option>
						{/foreach}
					</select>   
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">文章模板</label>
				<div class="layui-input-block">
					<select name="article_tpl" lay-verify="aihao">
						<option value="0">暂不选择</option>
						{foreach $pageTpl as $key => $vo}
							<option {if condition="$vo eq $model['article_tpl']"}selected{/if} value="{$vo}">{$vo}</option>
						{/foreach}
					</select>   
				</div>
			</div>
			<div class="layui-form-item">
				<div class="layui-input-block">
					<input type="hidden" name="id" value="{$model['id']}">
					<button class="layui-btn" lay-submit lay-filter="formDemo">立即提交</button>
					<button type="reset" class="layui-btn layui-btn-primary">重置</button>
				</div>
			</div>
    </form>
	</div>
</div>

<script type="text/javascript">
	layui.use(['form','upload'], function(){
  	var form = layui.form();
		form.on('submit(formDemo)', function(data){
			var that = this;
			$(that).attr("disabled","disabled");
			$.ajax({ 
				type: "post", 
				url: data.form.action, 
				data: data.field,
				dataType: 'json', 
				success: function(result){ 
					if(result['code'] == 1){
            window.location.href = document.referrer;
            layer.msg(result['msg']);
					}else{
						layer.msg(result['msg']);
						$(that).removeAttr("disabled");
					}
				} 
			});

			return false;
		});  
	})

	function preview_img(obj){
		layer.photos({
			photos: {
				data:[{src:$(obj).parent().parent().find(".preview_img").val()}]
			}
			,anim: 5
		});
	}
</script>
{/block}



