<style type="text/css">
    .boke-wrap .name{margin-left: 5px;}
</style>
<div class="boke-wrap">
    <div class="layui-tab">
        <ul class="layui-tab-title">
            <li class="layui-this">后台菜单列表</li>
            <li><a href="{:Url('add')}">添加后台菜单</a></li>
        </ul>
    </div>

    <div class="boke-table">
        <table class="layui-table layui-form">
            <thead>
                <tr>
                    <th width="3%">ID</th>
                    <th>菜单名称</th>
                    <th>菜单名称</th>
                    <th width="8%">排序ID</th>
                    <th width="10%">操作</th>
                </tr> 
            </thead>
            <tbody>
                {volist name="list['data']" id="vo"}
                    <tr data-id="{$vo.id}">
                        <td>{$vo.id}</td>
                        <td class='layui-elip'><i class="fa fa-caret-right"></i><span class="name">{$vo.name}</span></td>
                        <td class='layui-elip'>{$vo.app}/{$vo.model}/{$vo.action}</td>
                        <td class='layui-elip'>{$vo.listorder}</td>
                        <td>
                            <a class="layui-btn layui-btn-mini" href="{:Url('edit')}?id={$vo['id']}">编辑</a>
                            <a class="layui-btn layui-btn-mini layui-btn-danger" href="javascript:;" onclick="del({$vo.id})" >删除</a>
                        </td>
                    </tr>
                {/volist}
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="10"><button onclick="deleteAll()" class="layui-btn layui-btn-small">删除</button></td>
                </tr>
            </tfoot>
        </table>

        <div class="page">
            <div id="page"></div>
        </div>
    </div>

    <script type="text/javascript">
        layui.use(['tabletree', 'layer','form'], function(){


        });

        function deleteAll(){
            var ids = [];
            $($("input[name='checkboxId[]']")).each(function(){
                if( this.checked ){
                    ids.push($(this).val());
                }
            });
            del(ids);
        }

        function del(id){
            layer.confirm('是否确定删除？', {
                btn: ['是','否'] //按钮
            }, function(){
                $.ajax({
                    type : 'post',
                    url : "{:Url('deleteAll')}",
                    data : {id:id},
                    dataType: 'json',
                    success: function(result){
                        if(result['status'] == 200){
                            if($.isArray(id)){
                                $(id).each(function(index,value){
                                    console.log(value);
                                    $("tr[data-id="+value+"]").remove();
                                });
                            }else{
                                $("tr[data-id="+id+"]").remove();
                            }
                            
                            layer.closeAll();
                        }else{
                            layer.msg(result.msg);
                        }
                    }
                });
            });
        }
    </script>
</div>
