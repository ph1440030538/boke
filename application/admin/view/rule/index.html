{extend name="base" /}
{block name="head"}
{/block}
{block name="main"}
<div id="fuyun-app" class="fuyun-app">
  <div class="search-box">
    <div class="fuyun-title">
      <h5>筛选条件</h5>
    </div>
    <div class="search-content">
      <form action="" method="">
        <div class="fuyun-form-item layui-inline">
          <label>品牌名称</label>
          <input class="layui-input" type="text" name="brand_name" value="" placeholder="输入品牌名称">
        </div>
        <div class="fuyun-form-item layui-inline" style="padding-top:18px;">
          <button class="layui-btn layui-btn-normal">搜索</button>
        </div>
      </form>
    </div>
  </div>

  <div class="content-box">
    <div class="fuyun-title">
      <h5>权限规则列表</h5>
      <a href="javascript:;" class="layui-btn fuyun-add-btn layui-btn-small layui-btn-normal add"><i class="fa fa-plus-square margin-right-5"></i>添加品牌</a>
    </div>
    <div class="main-box">
      <div class="layui-form">
        <table class="layui-table" lay-even="">
          <thead>
            <th width="3%"><input type="checkbox" name="" lay-skin="primary" lay-filter="allChoose"></th>
            <th width="10%">规则名字</th>
            <th>规则</th>
            <th>参数</th>
            <th width="10%">验证</th>
            <th width="10%">操作</th>
          </thead>
          <tbody>
            {volist name="list['data']" id="vo"}
              <tr data-id="{$vo.id}">
                <td><input type="checkbox" name="id[]" lay-skin="primary" value="{$vo.id}" ></td>
                <td>{$vo.rule_name}</td>
                <td>{$vo.rule}</td>
                <td>{$vo.params}</td>
                <td><?=$vo['isAccept'] == 1 ? '通过':'拒绝'?></td>
                <td>
                  <div class="layui-btn-group">
                    <a class="layui-btn layui-btn-normal layui-btn-small edit" data-id="{$vo.id}" href="javascript:;">编辑</a>
                    <button class="layui-btn fuyun-btn-del layui-btn-small btn-del-id" data-url="{:Url('deleteAll')}" data-confirm="确定删除该分类吗？" data-successtip="删除成功！" data-id="<?=$vo['id']?>" ><i class="fa fa-close margin-right-5"></i>删除</button>
                  </div>
                </td>
              </tr>
            {/volist}
          </tbody>
          <tfoot>
            <tr>
              <th width="2%"><input type="checkbox" name="" lay-skin="primary" lay-filter="allChoose"></th>
              <th colspan="8" class="operator-button" style="text-align:left">
                  <button class="layui-btn layui-btn-small fuyun-btn-del btn-del-ids" data-url="{:Url('deleteAll')}" data-confirm="确定要批量删除吗?" data-successtip="批量删除成功!"  method-type="post" style="margin-top:5px"><i class="fa fa-close margin-right-5"></i>批量删除</button>
              </th>
            </tr>
          </tfoot>
        </table>
      </div>
      <div class="page-box">
        <fuyun-page 
          :pagesize="<?=$list['pageSize']?>" 
          :total = "<?=$list['totalRow']?>"
          :current-page = {$list['curPage']}
        ></fuyun-page>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
  layui.use('form', function(){
    var form = layui.form();
    //全选
    form.on('checkbox(allChoose)', function(data){
      var child = $(data.elem).parents('table').find('tbody input[type="checkbox"]');
      child.each(function(index, item){
        item.checked = data.elem.checked;
      });
      form.render('checkbox');
    });

    $(".add").click(function(){
      layer.open({
        type: 2,
        area:['480px','600px'],
        content: "{:Url('add')}"
      });
    });

    $(".edit").click(function(){
      var id = $(this).data('id');
      layer.open({
        type: 2,
        area:['480px','600px'],
        content: "{:Url('edit')}?id="+id
      });
    });
  });

  fuyun.components(['page'],{
    el:"#fuyun-app",
    data:{
      labelPosition: 'top',
    },
  });
</script>
{/block}
